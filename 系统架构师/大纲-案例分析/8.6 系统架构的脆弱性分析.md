## 软件架构的脆弱性分析

### 一、软件脆弱性的定义、特点和分类

> 软件的脆弱性是指由软件缺陷的客观存在所形成的一个可以被攻击者利用的实例，每个脆弱性都至少由一个软件缺陷引起的，但是一个软件缺陷也可能不产生任何脆弱性，而且不同的软件缺陷可能导致相同的脆弱性。

> 特点
>
> - 脆弱性是软件系统中隐藏的一个弱点，本身不会引起危害，但被利用后会产生严重的安全后果。
> - 在软件的开发过程中，自觉或不自觉引入的逻辑错误是大多数脆弱性的根本来源；
> - 与具体的系统环境密切相关，系统环境的任何差异都有可能导致不同的脆弱性问题。
> - 旧的脆弱性得到修补或纠正的同时可能引入新的脆弱性，因此脆弱性问题会长期存在。

> 分类
>
> ```mermaid
> flowchart LR
> A[软件缺陷]---B1[有意的]
> A---B2[无意的]
> B1---C1[恶意的]
> B1---C2[非恶意的]
> B2---C3[验证错误]
> B2---C4[抽象错误]
> B2---C5[异步错误]
> B2---C6[子组件误用/失败]
> B2---C7[功能性错误]
> C1---D1[缺陷]
> C1---D2[逻辑/时间炸弹]
> C2---D3[隐蔽通道]
> C2---D4[不一致的访问控制途径]
> C3---D5[寻址错误]
> C3---D6[不充分的参数值验证]
> C3---D7[不正确的检测位置]
> C3---D8[不充分鉴定/认证]
> C4---D9[对象重用缺陷]
> C4---D10[内部表示暴漏]
> C5---D11[并发]
> C5---D12[别名]
> C6---D13[资源泄露]
> C6---D14[功能的错误理解]
> C7---D15[错误处理故障]
> C7---D16[其他安全缺陷]
> D2---E1[存储]
> D2---E2[定时]
> ```
>
> 

### 二、软件脆弱性的生命周期

脆弱性的生命周期包含 **引入、产生破坏效果、被修补、消失**等阶段。

### 三、软件脆弱性的分析方法

脆弱性的分析可以从三个方面考虑：

- 分析软件故障现象，分析故障的技术本质、总结脆弱性模式
- 分析软件开发，发现安全管理和技术的薄弱环节，提高软件安全性
- 分析软件使用，发现其脆弱性，采取响应措施，避免脆弱性转化为安全故障。

### 四、典型的软件架构脆弱性分析（分层、C/S、B/S、事件驱动、MVC、微内核和微服务）

- **分层架构**：通常包含4个层次：表示层、业务层、持久层、数据库层
  - 层间脆弱性
  - 层间通信脆弱性
- **C/S架构**
  - 客户端软甲脆弱性
  - 网络开放性的脆弱性
  - 网络协议的脆弱性
- **B/S架构**
  - 系统如果使用HTTP协议，BS架构相对CS架构而言更容易被病毒入侵，虽然最新的HTTP协议在安全性方面有所提升，但是还是弱于CS
- **事件驱动**
  - 组件的脆弱性
  - 组件间交换数据的脆弱性
  - 组件间逻辑关系的脆弱性
  - 事件驱动容易进入死循环
  - 高并发的脆弱性
  - 固定流程的脆弱性
- **MVC架构**：应用可以被分为三层：模型层、视图层、控制层。
  - MVC架构的复杂性带来的脆弱性
  - 视图与控制器间紧密链接的脆弱性
  - 视图对模型数据的低效率访问的脆弱性
- **微内核结构**
  - 微内核架构难以进行良好的整体化优化。
  - 微内核系统的进程通信开销较单一内核系统要大得多。
  - 通信损失率高
- 微服务架构
  - 开发人员需要处理分布式系统的复杂结构
  - 开发人员要设计服务之间的通信机制，通过写代码来处理消息传递中速度过慢或者不可用等局部实效问题。
  - 服务管理的复杂性，在生产环境中药管理多个不同的服务实例，这意味着开发团队需要全局统筹。

